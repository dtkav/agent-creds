services:
  vault:
    build: ./vault
    ports:
      - "8080:8080"
      - "2222:2222"
    environment:
      - MACAROON_SIGNING_KEY=${MACAROON_SIGNING_KEY}
      - MACAROON_ENCRYPTION_KEY=${MACAROON_ENCRYPTION_KEY}
      - STRIPE_API_KEY=${STRIPE_API_KEY}
      - WEBAUTHN_RP_ID=${WEBAUTHN_RP_ID:-localhost}
      - WEBAUTHN_RP_ORIGIN=${WEBAUTHN_RP_ORIGIN:-http://localhost:8080}
      - WEBAUTHN_RP_NAME=${WEBAUTHN_RP_NAME:-Agent Credentials}
    volumes:
      - vault-data:/data
      - ./vault/vault.toml:/app/vault.toml:ro
    networks:
      - agent-creds

volumes:
  vault-data:

networks:
  agent-creds:
